# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:

- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:

- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```

## Сборка

```
npm run build
```

или

```
yarn build
```

## Описание проекта

Проект "Web-larёk" представляет из себя интернет-магазин с товарами для веб-разработчиков. В нём можно посмотреть каталог товаров, добавить товары в корзину и сделать заказ.

## Описание интерфейса

Интерфейс можно условно разделить на следующие процессы:

1. Просмотр каталога товаров, выбор и просмотр товара через модальное окно, добавление карточки в корзину (ProductView)
2. Просмотр корзины товаров (BasketView)
3. Оформление заказа (Form)

Все модальные окна используют один шаблон для вставки в верстку. Класс Modal отвечает за вставку темплейтов в верстку.

## Архитектура проекта (MVP)

Планируется соединять модель и отображение через Presenter и заранее заготовленный брокер событий.

### Базовый код

1. Класс **Api**
   Отвечает за запросы на сервер. Включает в себя все виды запросов: 'GET', 'POST', 'PUT', 'DELETE'.

2. Класс **EventEmitter**
   Брокер событий устанавливает оброботчик на события через метод "on", снимает "off", Инициировать событие с данными "emit", Слушает все события "onAll", Сбросить все обработчики "offAll", создает коллбек триггер, генерирующий событие при вызове "trigger".

### Компоненты модели данных (бизнес-логика)

#### Класс **BasketModel**

Отвечает за хранение данных о товарах в корзине. В массиве items определенный товар может записаться только один раз.

1. add - метод добавляет карточку в массив
2. remove - удаляет карточку из массива
3. sendOrder - формирование объекта для отправки POST запроса на сервер
4. cleanOrder - отчистка корзины после успешной отправки на сервер

Взаимодействует с отображением происходит через класс Presenter.

#### Класс **ProductAPI**

Наследует базовый класс **Api**, отвечает за получение данных о товаре с сервера: getProducts; и их отправку: postOrder.

- postOrder - принимает объект с данными вида:

```
interface FormData {
	payment: string;
	email: string;
	phone: string;
	address: string;
}

interface IOrder extends FormData {
	total: number;
	items: string[];
}
```

### Компоненты представления

#### Класс **ProductView**

Клас отвечающий за все 3 вида отображения карточек на страницу, включая галерею карточек товара, предпросмотр карточки товара и отображение карточки в корзине товаров.

1. renderGalleryCard - метод рендера карточки для галереи
2. renderCardPrewiew - метод рендера карточки превью
3. renderBasketCard - метод рендера карточки для коризны

Класс записывает данные карточек с сервера в массив cards, для дальнейшего переиспользования в рендере.

#### Класс **BasketView**

Класс отображения корзины товара.\
Имеет всего один метод render, который получает данные из модели через Presenter для отображение в верстке.

#### Класс **Form**

Общий класс формы, содержащий в себе:

1. formData: FormData - объект хранящий в себе данные ввода
2. setOrderForm - метод открывающий первую форму с полями оплаты и адреса
3. setContactsForm - метод открывающий вторую форму с почтой и телефоном
4. setValue - записывает данные формы

Помимо прочего в классе имеется ряд внутренних методов для валидации форм.

#### Класс **Modal**

Выведение темплейтов в интерфейс через метод сеттера content, который вставляет в контейнер Модального окна контент.

1. open() - метод отвечающий за открытие модального окна
2. close() - метод отвечающий за закрытие модального окна

#### Класс **Presenteer**

Класс соединяющий модель и отображения при помощи EventEmmiter. В конструктор принимает модель данных и ряд конструкторов классов.

```
init(): void;
getData(formData: { values: FormData }): void;
renderForm(): void;
renderBasket(): void;
openCardModal(item: { item: HTMLElement }): void;
addCard(card: { item: IProductCard }): void;
removeCard(card: { item: string }): void;
renderView(): void;
```

Через функцию инит происходит инициализация классов, которые используются в остальных методах. Через renderView данные отправляются в класс интерфейса карточек.

### Ключевые типы данных

Интерфейс данных товара для хранения в сжатом виде в BasketModel

```
interface IProduct {
id: string;
title: string;
price: number | null;
}
```

Данные приходящие с серведа для отображения в верстке

```
interface IProductCard extends IProduct {
image: string;
text: string;
price: number | null;
header: string;
category: string;
id: string;
}
```

Интерфейс данных получаемых из формы

```
interface FormData {
address?: string;
email?: string;
telephone?: string;
typeOfPayment?: string;
}
```
